namespace = th_scarlet_mists_incident_events
country_event = {
  id = th_scarlet_mists_incident_events.0
  title = "th_scarlet_mists_incident_events.0.t"
  desc = none
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_incident_check_year_for_incident = {
      incident = scarlet_mists_incident
      year = 1450
    }
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
    th_incident_can_trigger_generic_check = yes
  }
  fire_only_once = yes
  hidden = yes
  mean_time_to_happen = {
    months = 12
    modifier = {
      factor = 0.8
      OR = {
        exists = SCR
        AND = {
          exists = SCD
          SCD = {
            has_country_flag = scr_formed_scd
          }
        }
      }
    }
    modifier = {
      factor = 0.5
      OR = {
        SCR = {
          is_at_war = yes
        }
        SCD = {
          is_at_war = yes
        }
      }
    }
  }
  immediate = {
    th_incident_forbid_country_to_investigate = {
      who = SCR
    }
    th_incident_forbid_country_to_investigate = {
      who = SCD
    }
    th_incident_forbid_country_to_investigate = {
      who = CIN
    }
    th_incident_forbid_country_to_investigate = {
      who = FLR
    }
    th_incident_forbid_country_to_investigate = {
      who = HNG
    }
    th_start_incident_effect = {
      incident = scarlet_mists_incident
    }
    gensokyo_superregion = {
      limit = {
        owner = {
          NOT = {
            tag = SCR
          }
          NOT = {
            tag = SCD
          }
          NOT = {
            was_tag = SCR
          }
          NOT = {
            was_tag = SCD
          }
          NOT = {
            is_subject_of = SCR
          }
          NOT = {
            is_subject_of = SCD
          }
        }
        any_neighbor_province = {
          OR = {
            owned_by = SCR
            owned_by = SCD
          }
        }
        NOT = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
        }
      }
      add_province_modifier = {
        name = th_plagued_by_the_scarlet_mist
        duration = -1
        desc = th_incident_duration_tt
      }
    }
    random_province = {
      limit = {
        superregion = gensokyo_superregion
        owner = {
          NOT = {
            tag = SCR
          }
          NOT = {
            tag = SCD
          }
          NOT = {
            was_tag = SCR
          }
          NOT = {
            was_tag = SCD
          }
          NOT = {
            is_subject_of = SCR
          }
          NOT = {
            is_subject_of = SCD
          }
        }
        NOT = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
        }
      }
      add_province_modifier = {
        name = th_plagued_by_the_scarlet_mist
        duration = -1
        desc = th_incident_duration_tt
      }
    }
  }
  option = {
    random_country = {
      limit = {
        th_incident_can_become_investigator = yes
      }
      th_incident_setup_investigator = yes
      th_incident_introduction_event = {
        id = th_scarlet_mists_incident_events.1
      }
    }
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.1
  title = "th_scarlet_mists_incident_events.1.t"
  desc = {
    trigger = {
      OR = {
        tag = SCR
        was_tag = SCR
        tag = SCD
        was_tag = SCD
      }
    }
    desc = "th_scarlet_mists_incident_events.1.desc.1"
  }
  desc = {
    trigger = {
      NOT = {
        tag = SCR
      }
      NOT = {
        was_tag = SCR
      }
      NOT = {
        tag = SCD
      }
      NOT = {
        was_tag = SCD
      }
    }
    desc = "th_scarlet_mists_incident_events.1.desc.2"
  }
  picture = SCARLETMIST_eventPicture
  is_triggered_only = yes
  option = {
    name = "th_scarlet_mists_incident_events.1.a"
    trigger = {
      th_incident_is_investigator = yes
    }
    highlight = yes
    th_investigate_incident = {
      incident = scarlet_mists_incident
    }
    ai_chance = {
      factor = 100
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.1.b"
    trigger = {
      th_incident_is_investigator = yes
      th_is_not_major_main_character = yes
      th_is_not_minor_main_character = yes
      any_known_country = {
        th_incident_can_become_investigator = yes
      }
    }
    th_start_incident_tooltip = {
      incident = scarlet_mists_incident
    }
    th_refuse_investigating_incident = yes
    ai_chance = {
      factor = 0
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.1.c"
    trigger = {
      th_incident_is_not_investigator = yes
      OR = {
        tag = HKR
        tag = FOM
        tag = MRY
        AND = {
          th_incident_is_biasedly_picked_investigator = yes
          ai = no
        }
      }
      th_incident_can_become_investigator = yes
    }
    highlight = yes
    th_investigate_incident = {
      incident = scarlet_mists_incident
    }
    hidden_effect = {
      th_incident_clr_previous_investigators = yes
      th_incident_set_country_to_new_investigator = yes
    }
    ai_chance = {
      factor = 0
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.1.d"
    trigger = {
      th_incident_is_not_investigator = yes
      NOT = {
        tag = SCR
      }
      NOT = {
        tag = SCD
      }
      NOT = {
        was_tag = SCR
      }
      NOT = {
        was_tag = SCD
      }
    }
    th_start_incident_tooltip = {
      incident = scarlet_mists_incident
    }
    ai_chance = {
      factor = 100
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.1.e"
    trigger = {
      OR = {
        tag = SCR
        was_tag = SCR
        tag = SCD
        was_tag = SCD
      }
    }
    th_start_incident_tooltip = {
      incident = scarlet_mists_incident
    }
    highlight = yes
    add_army_tradition = 15
    add_navy_tradition = 15
    add_treasury = 200
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.2
  title = "th_scarlet_mists_incident_events.2.t"
  desc = "th_scarlet_mists_incident_events.2.desc"
  picture = RUMIA_eventPicture
  trigger = {
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_incident_is_investigator = yes
    th_incident_current_stage = {
      stage = 1
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_rumias_combat_skills
        value = 950
      }
      th_defineopponent_fighting_skill = {
        variable = th_SDM_inci_rumias_combat_skills
        type = incident
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.2.a"
    custom_tooltip = th_scarlet_mists_incident_events.2.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 40
      modifier = {
        factor = 100
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 0
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.2.b"
    custom_tooltip = th_scarlet_mists_incident_events.2.b.tt
    add_yearly_manpower = -0.5
    hidden_effect = {
      every_known_country = {
        limit = {
          any_owned_province = {
            range = ROOT
          }
        }
        add_opinion = {
          modifier = th_fed_fairies_to_rumia
          who = ROOT
        }
      }
    }
    th_incident_cruel_decision = yes
    th_incident_change_points = {
      value = 2
    }
    ai_chance = {
      factor = 20
      modifier = {
        factor = 100
        OR = {
          ruler_has_personality = malevolent_personality
          ruler_has_personality = cruel_personality
        }
      }
      modifier = {
        factor = 0
        ruler_has_personality = kind_hearted_personality
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.2.c"
    custom_tooltip = th_scarlet_mists_incident_events.2.c.tt
    trigger = {
      num_of_allies = 1
    }
    random_ally = {
      country_event = {
        id = th_scarlet_mists_incident_events.13
      }
    }
    th_incident_change_points = {
      value = 1
    }
    ai_chance = {
      factor = 20
      modifier = {
        factor = 100
        any_ally = {
          trust = {
            who = ROOT
            value = 60
          }
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.2.d"
    custom_tooltip = th_scarlet_mists_incident_events.2.d.tt
    add_prestige = -5
    th_incident_change_points = {
      value = -1
    }
    ai_chance = {
      factor = 20
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.3
  title = "th_scarlet_mists_incident_events.3.t"
  desc = "th_scarlet_mists_incident_events.3.desc"
  picture = CIRNO_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 2
    }
    th_incident_is_investigator = yes
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_cirnos_combat_skills
        value = 999
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_cirnos_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.3.a"
    custom_tooltip = th_scarlet_mists_incident_events.3.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 40
      modifier = {
        factor = 100
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 0
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.3.b"
    custom_tooltip = th_scarlet_mists_incident_events.3.b.tt
    add_prestige = -5
    add_country_modifier = {
      name = th_SDM_inci_unchecked_cirno_rampage
      duration = 1825
    }
    th_incident_change_points = {
      value = 1
    }
    ai_chance = {
      factor = 15
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.3.c"
    trigger = {
      exists = CIN
      CIN = {
        is_subject_of = ROOT
      }
    }
    custom_tooltip = th_scarlet_mists_incident_events.3.c.tt
    add_prestige = 25
    th_incident_change_points = {
      value = 3
    }
    ai_chance = {
      factor = 100
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.3.d"
    trigger = {
      adm = 3
      dip = 3
    }
    custom_tooltip = th_scarlet_mists_incident_events.3.d.tt
    add_dip_power = -75
    random_list = {
      75 = {
        custom_tooltip = th_scarlet_mists_incident_events.3.d.success
        add_prestige = 10
        th_incident_change_points = {
          value = 2
        }
      }
      25 = {
        custom_tooltip = th_scarlet_mists_incident_events.3.d.fail
        add_prestige = -5
        th_incident_change_points = {
          value = -1
        }
      }
    }
    ai_chance = {
      factor = 30
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.3.e"
    custom_tooltip = th_scarlet_mists_incident_events.3.e.tt
    add_adm_power = 125
    th_incident_change_points = {
      value = -2
    }
    ai_chance = {
      factor = 15
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.4
  title = "th_scarlet_mists_incident_events.4.t"
  desc = "th_scarlet_mists_incident_events.4.desc"
  picture = MEILINGBOSS_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 3
    }
    th_incident_is_investigator = yes
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_meilings_combat_skills
        value = 1125
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_meilings_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.4.a"
    custom_tooltip = th_scarlet_mists_incident_events.4.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 75
      modifier = {
        factor = 100
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 0
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.4.d"
    custom_tooltip = th_scarlet_mists_incident_events.4.d.tt
    trigger = {
      OR = {
        th_is_emperor_of_china = yes
        AND = {
          is_subject_of_type = tributary_state
          overlord = {
            th_is_emperor_of_china = yes
          }
        }
      }
    }
    add_prestige = 25
    th_incident_change_points = {
      value = 3
    }
    ai_chance = {
      factor = 100
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.4.e"
    custom_tooltip = th_scarlet_mists_incident_events.4.e.tt
    add_adm_power = 25
    add_prestige = -25
    th_incident_change_points = {
      value = -2
    }
    ai_chance = {
      factor = 25
      modifier = {
        factor = 0
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 100
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.5
  title = "th_scarlet_mists_incident_events.5.t"
  desc = "th_scarlet_mists_incident_events.5.desc"
  picture = PATCHOULI_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 4
    }
    th_incident_is_investigator = yes
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_patchoulis_combat_skills
        value = 1250
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_patchoulis_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.5.a"
    custom_tooltip = th_scarlet_mists_incident_events.5.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 75
      modifier = {
        factor = 100
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 0
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.5.b"
    custom_tooltip = th_scarlet_mists_incident_events.5.b.tt
    add_adm_power = -50
    add_years_of_income = -0.5
    th_incident_change_points = {
      value = 1
    }
    ai_chance = {
      factor = 25
      modifier = {
        factor = 0
        th_winnable_fight_trigger = {
          type = incident
        }
      }
      modifier = {
        factor = 100
        th_unwinnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.5.c"
    trigger = {
      OR = {
        AND = {
          alliance_with = FOM
          reverse_has_opinion = {
            who = FOM
            value = 150
          }
        }
        FOM = {
          is_subject_of = ROOT
        }
        tag = FOM
      }
    }
    custom_tooltip = th_scarlet_mists_incident_events.5.c.tt
    add_adm_power = -50
    th_incident_change_points = {
      value = 2
    }
    ai_chance = {
      factor = 100
      modifier = {
        factor = 0
        th_winnable_fight_trigger = {
          type = incident
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.6
  title = "th_scarlet_mists_incident_events.6.t"
  desc = "th_scarlet_mists_incident_events.6.desc"
  picture = SAKUYA_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 5
    }
    th_incident_is_investigator = yes
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_sakuyas_combat_skills
        value = 1400
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_sakuyas_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.6.a"
    custom_tooltip = th_scarlet_mists_incident_events.6.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.7
  title = "th_scarlet_mists_incident_events.7.t"
  desc = "th_scarlet_mists_incident_events.7.desc"
  picture = REMILIA_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 6
    }
    th_incident_is_investigator = yes
    th_enough_time_for_next_stage_has_passed = {
      days = 1095
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_remilias_combat_skills
        value = 1500
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_remilias_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.7.a"
    custom_tooltip = th_scarlet_mists_incident_events.7.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.8
  title = "th_scarlet_mists_incident_events.8.t"
  desc = "th_scarlet_mists_incident_events.8.desc"
  picture = FLANDRE_eventPicture
  is_triggered_only = yes
  immediate = {
    hidden_effect = {
      th_prepare_for_next_stage = yes
      th_getruler_fighting_skill = {
        skill_boni = 0
        type = incident
      }
      set_variable = {
        which = th_SDM_inci_flandres_combat_skills
        value = 1600
      }
      th_defineopponent_fighting_skill = {
        type = incident
        variable = th_SDM_inci_flandres_combat_skills
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.8.a"
    custom_tooltip = th_scarlet_mists_incident_events.8.a.tt
    highlight = yes
    th_danmaku_incident_fight_ruler_and_opponent = yes
    hidden_effect = {
      country_event = {
        id = th_scarlet_mists_incident_events.12
        days = 90
      }
    }
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.16
  title = "th_scarlet_mists_incident_events.16.t"
  desc = "th_scarlet_mists_incident_events.16.desc"
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_incident_current_stage = {
      stage = 7
    }
    has_country_flag = th_incident_last_fight_terribly_lost
    th_incident_is_investigator = yes
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_country_flag = th_just_finished_incident_danmaku_fight
    }
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    months = 12
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.16.a"
    custom_tooltip = th_scarlet_mists_incident_events.16.a.tt
    if = {
      limit = {
        exists = SCD
      }
      SCD = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    else_if = {
      limit = {
        exists = SCR
      }
      SCR = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    add_adm_power = -100
    add_prestige = -10
    add_devotion = -10
    custom_tooltip = th_scarlet_mists_incident_events_scarlet_mist
    hidden_effect = {
      gensokyo_superregion = {
        limit = {
          NOT = {
            owned_by = SCR
          }
          NOT = {
            owned_by = SCD
          }
          NOT = {
            owned_by = FLR
          }
        }
        add_province_modifier = {
          name = th_the_scarlet_mist
          duration = 1825
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.9
  title = "th_scarlet_mists_incident_events.9.t"
  desc = "th_scarlet_mists_incident_events.9.desc"
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_incident_is_investigator = yes
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
    th_incident_check_point_result = {
      value = 0
    }
    NOT = {
      th_incident_check_point_result = {
        value = 5
      }
    }
    NOT = {
      has_country_flag = th_incident_last_fight_terribly_lost
    }
    th_incident_current_stage = {
      stage = 7
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_country_flag = th_just_finished_incident_danmaku_fight
    }
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    months = 12
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.9.a"
    custom_tooltip = th_scarlet_mists_incident_events.9.a.tt
    if = {
      limit = {
        exists = SCD
      }
      SCD = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    else_if = {
      limit = {
        exists = SCR
      }
      SCR = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    add_adm_power = -100
    add_prestige = -10
    add_devotion = -10
    custom_tooltip = th_scarlet_mists_incident_events_scarlet_mist
    hidden_effect = {
      gensokyo_superregion = {
        limit = {
          NOT = {
            owned_by = SCR
          }
          NOT = {
            owned_by = SCD
          }
          NOT = {
            owned_by = FLR
          }
        }
        add_province_modifier = {
          name = th_the_scarlet_mist
          duration = 1825
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.10
  title = "th_scarlet_mists_incident_events.10.t"
  desc = "th_scarlet_mists_incident_events.10.desc"
  picture = SHRINE_eventPicture
  trigger = {
    th_incident_is_investigator = yes
    NOT = {
      has_country_flag = th_incident_last_fight_terribly_lost
    }
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
    th_incident_check_point_result = {
      value = 5
    }
    NOT = {
      th_incident_check_point_result = {
        value = 10
      }
    }
    th_incident_current_stage = {
      stage = 7
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_country_flag = th_just_finished_incident_danmaku_fight
    }
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    months = 12
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.10.a"
    th_solve_incident = {
      incident = scarlet_mists_incident
    }
    if = {
      limit = {
        OR = {
          was_tag = HKR
          tag = HKR
          was_tag = FOM
          tag = FOM
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 9125
      }
    }
    else = {
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 3650
      }
    }
    add_adm_power = 100
    add_prestige = 25
    add_devotion = 10
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.11
  title = "th_scarlet_mists_incident_events.11.t"
  desc = "th_scarlet_mists_incident_events.11.desc"
  picture = THFEST_eventPicture
  trigger = {
    th_incident_check_point_result = {
      value = 10
    }
    th_incident_is_investigator = yes
    NOT = {
      has_country_flag = th_incident_last_fight_terribly_lost
    }
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
    th_incident_current_stage = {
      stage = 7
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_country_flag = th_just_finished_incident_danmaku_fight
    }
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    months = 12
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.11.b"
    th_solve_incident = {
      incident = scarlet_mists_incident
    }
    custom_tooltip = th_scarlet_mists_incident_events.11.b.tt
    highlight = yes
    add_adm_power = -25
    add_prestige = 35
    if = {
      limit = {
        OR = {
          was_tag = HKR
          tag = HKR
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 9125
      }
    }
    else_if = {
      limit = {
        OR = {
          was_tag = FOM
          tag = FOM
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 9125
      }
    }
    else = {
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 3650
      }
    }
    hidden_effect = {
      country_event = {
        id = th_scarlet_mists_incident_events.8
        days = 90
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.11.a"
    th_solve_incident = {
      incident = scarlet_mists_incident
    }
    if = {
      limit = {
        OR = {
          was_tag = HKR
          tag = HKR
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 9125
      }
    }
    else_if = {
      limit = {
        OR = {
          was_tag = FOM
          tag = FOM
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 9125
      }
    }
    else = {
      add_country_modifier = {
        name = "th_SDM_inci_mist_stopped"
        duration = 3650
      }
    }
    add_adm_power = 150
    add_prestige = 25
    add_devotion = 10
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.12
  title = "th_scarlet_mists_incident_events.12.t"
  desc = "th_scarlet_mists_incident_events.12.desc"
  picture = THFEST_eventPicture
  is_triggered_only = yes
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.12.a"
    custom_tooltip = th_scarlet_mists_incident_events.12.a.tt
    th_solve_incident_extra = {
      incident = scarlet_mists_incident
    }
    if = {
      limit = {
        OR = {
          was_tag = HKR
          tag = HKR
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_extra"
        duration = 9125
      }
    }
    else_if = {
      limit = {
        OR = {
          was_tag = FOM
          tag = FOM
        }
      }
      add_country_modifier = {
        name = "th_SDM_inci_extra"
        duration = 9125
      }
    }
    else = {
      add_country_modifier = {
        name = "th_SDM_inci_extra"
        duration = 3650
      }
    }
    add_adm_power = 150
    if = {
      limit = {
        has_country_flag = th_increased_donations_from_events
      }
      add_years_of_income = 3
    }
    else = {
      add_years_of_income = 2
    }
    add_prestige = 50
    add_devotion = 10
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.13
  title = "th_scarlet_mists_incident_events.13.t"
  desc = "th_scarlet_mists_incident_events.13.desc"
  picture = RUMIA_eventPicture
  is_triggered_only = yes
  option = {
    name = "th_scarlet_mists_incident_events.13.a"
    add_mil_power = -75
    add_prestige = 15
    FROM = {
      country_event = {
        id = th_scarlet_mists_incident_events.14
      }
    }
    reverse_add_opinion = {
      who = FROM
      modifier = th_helped_us_to_deal_with_Rumia
    }
    ai_chance = {
      factor = 60
      modifier = {
        factor = 100
        FROM = {
          trust = {
            who = ROOT
            value = 75
          }
        }
      }
      modifier = {
        factor = 0
        NOT = {
          FROM = {
            trust = {
              who = ROOT
              value = 60
            }
          }
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.13.b"
    add_dip_power = -10
    add_mil_power = 100
    add_prestige = 15
    FROM = {
      country_event = {
        id = th_scarlet_mists_incident_events.15
      }
    }
    reverse_add_opinion = {
      who = FROM
      modifier = th_sent_Rumia_back
    }
    ai_chance = {
      factor = 40
      modifier = {
        factor = 100
        NOT = {
          FROM = {
            trust = {
              who = ROOT
              value = 60
            }
          }
        }
      }
      modifier = {
        factor = 0
        FROM = {
          trust = {
            who = ROOT
            value = 75
          }
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.13.c"
    trigger = {
      OR = {
        tag = SFF
        th_has_mil_advisor_3 = yes
        ruler_has_good_mil_personality = yes
      }
    }
    highlight = yes
    add_mil_power = -25
    add_prestige = 25
    define_general = {
      name = "2—s|Z"  # Rumia
      female = yes
      shock = 6
      fire = 4
      manuever = 0
      siege = 2
    }
    FROM = {
      country_event = {
        id = th_scarlet_mists_incident_events.14
      }
    }
    reverse_add_opinion = {
      who = FROM
      modifier = th_helped_us_to_deal_with_Rumia
    }
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.14
  title = "th_scarlet_mists_incident_events.14.t"
  desc = "th_scarlet_mists_incident_events.14.desc"
  picture = RUMIA_eventPicture
  is_triggered_only = yes
  option = {
    name = "th_scarlet_mists_incident_events.14.a"
    add_dip_power = 25
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.15
  title = "th_scarlet_mists_incident_events.15.t"
  desc = "th_scarlet_mists_incident_events.15.desc"
  picture = RUMIA_eventPicture
  is_triggered_only = yes
  option = {
    name = "th_scarlet_mists_incident_events.15.a"
    add_mil_power = -75
    add_stability = -1
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.17
  title = "th_scarlet_mists_incident_events.17.t"
  desc = "th_scarlet_mists_incident_events.17.desc"
  picture = SCARLETMIST_eventPicture
  trigger = {
    is_free_or_tributary_trigger = yes
    any_neighbor_country = {
      NOT = {
        is_subject_of = ROOT
      }
      NOT = {
        alliance_with = ROOT
      }
      any_owned_province = {
        NOT = {
          is_core = ROOT
        }
        NOT = {
          is_claim = ROOT
        }
        any_neighbor_province = {
          owned_by = ROOT
        }
      }
    }
    th_is_or_was_tag = {
      tag = SCR
    }
    has_country_modifier = th_SDM_scarlet_night
  }
  mean_time_to_happen = {
    months = 12
  }
  option = {
    name = "th_scarlet_mists_incident_events.17.a"
    random_neighbor_country = {
      limit = {
        NOT = {
          alliance_with = ROOT
        }
        NOT = {
          is_subject_of = ROOT
        }
        any_owned_province = {
          NOT = {
            is_core = ROOT
          }
          NOT = {
            is_claim = ROOT
          }
          any_neighbor_province = {
            owned_by = ROOT
          }
        }
      }
      random_owned_province = {
        limit = {
          NOT = {
            is_core = ROOT
          }
          NOT = {
            is_claim = ROOT
          }
          any_neighbor_province = {
            owned_by = ROOT
          }
        }
        add_claim = ROOT
      }
    }
    add_prestige = 10
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.18
  title = "th_scarlet_mists_incident_events.18.t"
  desc = "th_scarlet_mists_incident_events.18.desc"
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_is_or_was_tag = {
      tag = SCR
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
  }
  fire_only_once = yes
  major = yes
  mean_time_to_happen = {
    months = 12
  }
  option = {
    name = "th_scarlet_mists_incident_events.18.a"
    add_country_modifier = {
      name = "th_SDM_scarlet_night"
      duration = 9125
    }
  }
}
province_event = {
  id = th_scarlet_mists_incident_events.19
  title = "th_scarlet_mists_incident_events.19.t"
  desc = "th_scarlet_mists_incident_events.19.desc"
  picture = SCARLETMIST_eventPicture
  goto = ROOT
  trigger = {
    owner = {
      ai = no
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_province_flag = scarlet_revolt
    }
    NOT = {
      local_autonomy = 1
    }
    OR = {
      area = Scarlett_domain
      area = Scarlet_island
      area = Scarlet_mountain
    }
    culture = "Scarlett"
    owner = {
      NOT = {
        tag = SCR
      }
      NOT = {
        tag = SCD
      }
      is_free_or_tributary_trigger = yes
      num_of_cities = 4
    }
  }
  mean_time_to_happen = {
    months = 30
    modifier = {
      factor = 0.5
      any_neighbor_province = {
        has_province_flag = scarlet_revolt
      }
    }
    modifier = {
      factor = 0.5
      has_owner_religion = no
    }
    modifier = {
      factor = 0.5
      owner = {
        NOT = {
          culture_group = ROOT
        }
      }
    }
    modifier = {
      factor = 0.5
      owner = {
        NOT = {
          primary_culture = ROOT
        }
        NOT = {
          accepted_culture = ROOT
        }
      }
    }
    modifier = {
      factor = 0.5
      owner = {
        war_with = SCR
      }
    }
    modifier = {
      factor = 0.75
      unrest = 3
    }
    modifier = {
      factor = 0.75
      unrest = 5
    }
    modifier = {
      factor = 0.75
      unrest = 7
    }
    modifier = {
      factor = 0.75
      unrest = 9
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.19.a"
    set_province_flag = scarlet_revolt
    spawn_rebels = {
      type = nationalist_rebels
      size = 1
      friend = SCR
    }
    ai_chance = {
      factor = 90
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.19.b"
    cede_province = SCR
    ai_chance = {
      factor = 10
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.20
  title = "th_scarlet_mists_incident_events.20.t"
  desc = "th_scarlet_mists_incident_events.20.desc"
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    NOT = {
      has_country_flag = crd_appealed_remilia
    }
    overlord_of = SCR
    SCR = {
      NOT = {
        has_country_modifier = th_SDM_demands_independence
      }
      NOT = {
        has_country_modifier = th_inci_rebellious_subject
      }
    }
  }
  mean_time_to_happen = {
    months = 1
  }
  option = {
    name = "th_scarlet_mists_incident_events.20.a"
    if = {
      limit = {
        th_is_or_was_tag = {
          tag = CRD
        }
      }
      SCR = {
        add_country_modifier = {
          name = "th_inci_rebellious_subject"
          duration = 5475
        }
      }
    }
    else = {
      SCR = {
        add_country_modifier = {
          name = "th_SDM_demands_independence"
          duration = 5475
        }
      }
    }
    ai_chance = {
      factor = 90
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.20.b"
    trigger = {
      NOT = {
        th_is_or_was_tag = {
          tag = CRD
        }
      }
    }
    SCR = {
      grant_independence = yes
    }
    ai_chance = {
      factor = 10
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.21
  title = "th_scarlet_mists_incident_events.21.t"
  desc = "th_scarlet_mists_incident_events.21.desc"
  picture = SHRINE_eventPicture
  trigger = {
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    OR = {
      tag = HKR
      tag = MRY
      tag = FOM
      AND = {
        tag = GNK
        has_reform = Gensokyan_shrine_theocracy
      }
      th_incident_is_investigator = yes
    }
    any_known_country = {
      any_owned_province = {
        has_province_modifier = th_plagued_by_the_scarlet_mist
      }
    }
  }
  mean_time_to_happen = {
    months = 24
    modifier = {
      factor = 0.5
      NOT = {
        th_incident_check_point_result = {
          value = 10
        }
      }
    }
  }
  immediate = {
    hidden_effect = {
      random_known_country = {
        limit = {
          any_owned_province = {
            NOT = {
              has_province_flag = th_first_clean_dummy
            }
            NOT = {
              has_province_flag = th_second_clean_dummy
            }
            has_province_modifier = th_plagued_by_the_scarlet_mist
          }
        }
        random_owned_province = {
          limit = {
            has_province_modifier = th_plagued_by_the_scarlet_mist
          }
          set_province_flag = th_first_clean_dummy
        }
      }
      random_known_country = {
        limit = {
          any_owned_province = {
            NOT = {
              has_province_flag = th_first_clean_dummy
            }
            NOT = {
              has_province_flag = th_second_clean_dummy
            }
            has_province_modifier = th_plagued_by_the_scarlet_mist
          }
        }
        random_owned_province = {
          limit = {
            has_province_modifier = th_plagued_by_the_scarlet_mist
          }
          set_province_flag = th_second_clean_dummy
        }
      }
    }
  }
  after = {
    hidden_effect = {
      every_province = {
        limit = {
          has_province_flag = th_first_clean_dummy
        }
        clr_province_flag = th_first_clean_dummy
      }
      every_province = {
        limit = {
          has_province_flag = th_second_clean_dummy
        }
        clr_province_flag = th_second_clean_dummy
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.21.a"
    add_years_of_income = -0.2
    add_adm_power = 25
    random_known_country = {
      limit = {
        any_owned_province = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_first_clean_dummy
        }
      }
      random_owned_province = {
        limit = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_first_clean_dummy
        }
        remove_province_modifier = th_plagued_by_the_scarlet_mist
        clr_province_flag = th_first_clean_dummy
      }
    }
    random_known_country = {
      limit = {
        any_owned_province = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_second_clean_dummy
        }
      }
      random_owned_province = {
        limit = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_second_clean_dummy
        }
        remove_province_modifier = th_plagued_by_the_scarlet_mist
        clr_province_flag = th_second_clean_dummy
      }
    }
    if = {
      limit = {
        th_incident_is_investigator = yes
      }
      custom_tooltip = th_scarlet_mists_incident_events.21.a.tt
      th_incident_change_points = {
        value = 1
      }
    }
    ai_chance = {
      factor = 75
      modifier = {
        factor = 0
        NOT = {
          years_of_income = 0.3
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.21.b"
    custom_tooltip = th_scarlet_mists_incident_events.21.b.tt
    add_adm_power = 10
    random_known_country = {
      limit = {
        any_owned_province = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_first_clean_dummy
        }
      }
      random_owned_province = {
        limit = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
          has_province_flag = th_first_clean_dummy
        }
        remove_province_modifier = th_plagued_by_the_scarlet_mist
        clr_province_flag = th_first_clean_dummy
      }
    }
    ai_chance = {
      factor = 25
      modifier = {
        factor = 100
        NOT = {
          years_of_income = 0.3
        }
      }
    }
  }
}
province_event = {
  id = th_scarlet_mists_incident_events.25
  title = "th_scarlet_mists_incident_events.25.t"
  desc = "th_scarlet_mists_incident_events.25.desc"
  picture = SCARLETT_eventPicture
  trigger = {
    NOT = {
      has_province_modifier = th_plagued_by_the_scarlet_mist
    }
    NOT = {
      has_province_modifier = th_just_cured_of_the_mist
    }
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    superregion = gensokyo_superregion
    NOT = {
      culture = "Scarlett"
    }
    owner = {
      NOT = {
        tag = SCR
      }
      NOT = {
        tag = SCD
      }
      NOT = {
        AND = {
          tag = CRD
          overlord_of = SCR
        }
      }
    }
  }
  mean_time_to_happen = {
    months = 60
    modifier = {
      factor = 0.25
      any_neighbor_province = {
        has_province_flag = scarlet_revolt
      }
    }
  }
  hidden = yes
  option = {
    name = "th_scarlet_mists_incident_events.25.a"
    add_province_modifier = {
      name = th_plagued_by_the_scarlet_mist
      duration = -1
      desc = th_incident_duration_tt
    }
    ai_chance = {
      factor = 100
    }
  }
}
province_event = {
  id = th_scarlet_mists_incident_events.24
  title = "th_scarlet_mists_incident_events.24.t"
  desc = "th_scarlet_mists_incident_events.24.desc"
  picture = SHRINE_eventPicture
  goto = root
  trigger = {
    has_province_modifier = th_plagued_by_the_scarlet_mist
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    superregion = gensokyo_superregion
  }
  mean_time_to_happen = {
    months = 24
  }
  is_mtth_scaled_to_size = 1
  immediate = {
    hidden_effect = {
      owner = {
        save_event_target_as = th_sdm_province_owner
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.24.a"
    owner = {
      add_years_of_income = -0.25
    }
    every_province_in_state = {
      limit = {
        any_province_in_state = {
          province_id = ROOT
        }
        owned_by = event_target:th_sdm_province_owner
      }
      remove_province_modifier = th_plagued_by_the_scarlet_mist
      add_province_modifier = {
        name = th_just_cured_of_the_mist
        duration = 720
      }
    }
    if = {
      limit = {
        owner = {
          th_incident_is_investigator = yes
        }
      }
      custom_tooltip = th_scarlet_mists_incident_events.21.a.tt
      th_incident_change_points = {
        value = 1
      }
    }
    ai_chance = {
      factor = 75
      modifier = {
        factor = 0
        NOT = {
          owner = {
            years_of_income = 0.4
          }
        }
      }
      modifier = {
        factor = 0
        owner = {
          years_of_income = 0.7
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.24.b"
    owner = {
      add_years_of_income = -0.8
    }
    every_province_in_state = {
      limit = {
        any_province_in_state = {
          province_id = ROOT
        }
        owned_by = event_target:th_sdm_province_owner
      }
      if = {
        limit = {
          owner = {
            th_incident_is_investigator = yes
          }
        }
        th_incident_change_points = {
          value = 1
        }
      }
      remove_province_modifier = th_plagued_by_the_scarlet_mist
      add_province_modifier = {
        name = th_just_cured_of_the_mist
        duration = 1825
      }
    }
    if = {
      limit = {
        owner = {
          th_incident_is_investigator = yes
        }
      }
      th_incident_change_points = {
        value = 3
      }
    }
    ai_chance = {
      factor = 75
      modifier = {
        factor = 0
        NOT = {
          owner = {
            years_of_income = 0.7
          }
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.24.c"
    every_province_in_state = {
      limit = {
        any_province_in_state = {
          province_id = ROOT
        }
        owned_by = event_target:th_sdm_province_owner
        has_province_modifier = th_plagued_by_the_scarlet_mist
      }
      add_local_autonomy = 10
    }
    ai_chance = {
      factor = 25
      modifier = {
        factor = 100
        NOT = {
          owner = {
            years_of_income = 0.2
          }
        }
      }
    }
  }
}
province_event = {
  id = th_scarlet_mists_incident_events.260
  title = "th_scarlet_mists_incident_events.260.t"
  desc = "th_scarlet_mists_incident_events.260.desc"
  picture = SHRINE_eventPicture
  trigger = {
    OR = {
      has_province_modifier = th_plagued_by_the_scarlet_mist
      has_province_modifier = th_just_cured_of_the_mist
    }
    OR = {
      owner = {
        OR = {
          th_is_or_was_tag = {
            tag = SCR
          }
          is_subject_of = SCR
        }
      }
      th_does_not_have_current_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  hidden = yes
  option = {
    name = "th_scarlet_mists_incident_events.260.a"
    remove_province_modifier = th_plagued_by_the_scarlet_mist
    remove_province_modifier = th_just_cured_of_the_mist
    ai_chance = {
      factor = 100
    }
  }
}
province_event = {
  id = th_scarlet_mists_incident_events.270
  title = "th_scarlet_mists_incident_events.270.t"
  desc = "th_scarlet_mists_incident_events.270.desc"
  picture = SHRINE_eventPicture
  trigger = {
    OR = {
      has_province_flag = th_first_clean_dummy
      has_province_flag = th_second_clean_dummy
    }
  }
  mean_time_to_happen = {
    days = 2
  }
  hidden = yes
  option = {
    name = "th_scarlet_mists_incident_events.270.a"
    clr_province_flag = th_first_clean_dummy
    clr_province_flag = th_second_clean_dummy
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.271
  title = th_scarlet_mists_incident_events.271.t
  desc = th_scarlet_mists_incident_events.271.desc
  picture = SCARLETMIST_eventPicture
  trigger = {
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    OR = {
      tag = SCR
      tag = SCD
      tag = CIN
      was_tag = SCR
      was_tag = SCD
      was_tag = CIN
    }
    NOT = {
      has_country_flag = th_is_not_valid_for_investiagtor_role
    }
  }
  mean_time_to_happen = {
    days = 1
  }
  hidden = yes
  option = {
    name = th_scarlet_mists_incident_events.271.a
    set_country_flag = th_is_not_valid_for_investiagtor_role
    ai_chance = {
      factor = 100
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.26
  title = "th_scarlet_mists_incident_events.26.t"
  desc = "th_scarlet_mists_incident_events.26.desc"
  picture = SCARLETT_eventPicture
  trigger = {
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    gensokyo_superregion = {
      OR = {
        owned_by = SCR
        owned_by = SCD
        owner = {
          is_subject_of = SCR
        }
        owner = {
          is_subject_of = SCD
        }
      }
    }
    OR = {
      tag = SCR
      tag = SCD
    }
    all_country = {
      th_incident_can_not_become_investigator = yes
    }
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    days = 5
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.26.a"
    custom_tooltip = th_scarlet_mists_incident_events.26.a.tt
    add_country_modifier = {
      name = "th_SDM_inci_mist_spreading"
      duration = 9125
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.27
  title = "th_scarlet_mists_incident_events.27.t"
  desc = "th_scarlet_mists_incident_events.27.desc"
  picture = SCARLETT_eventPicture
  trigger = {
    th_current_incident = {
      incident = scarlet_mists_incident
    }
    gensokyo_superregion = {
      NOT = {
        owned_by = SCR
      }
      NOT = {
        owner = {
          is_subject_of = SCR
        }
      }
      NOT = {
        owned_by = SCD
      }
      NOT = {
        owner = {
          is_subject_of = SCD
        }
      }
    }
    owns = 4968
    all_country = {
      th_incident_can_not_become_investigator = yes
    }
    NOT = {
      th_incident_has_been_resolved = {
        incident = scarlet_mists_incident
      }
    }
  }
  mean_time_to_happen = {
    days = 5
  }
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.27.a"
    trigger = {
      OR = {
        tag = SCR
        was_tag = SCR
      }
    }
    custom_tooltip = th_scarlet_mists_incident_events.27.a.tt
    add_country_modifier = {
      name = "th_SDM_inci_mist_spreading"
      duration = 3650
    }
    custom_tooltip = th_scarlet_mists_incident_events_scarlet_mist
    hidden_effect = {
      gensokyo_superregion = {
        limit = {
          NOT = {
            owned_by = SCR
          }
          NOT = {
            owned_by = SCD
          }
          NOT = {
            owned_by = FLR
          }
        }
        add_province_modifier = {
          name = th_the_scarlet_mist
          duration = 1825
        }
      }
    }
  }
  option = {
    name = "th_scarlet_mists_incident_events.27.b"
    trigger = {
      NOT = {
        tag = SCR
      }
      NOT = {
        was_tag = SCR
      }
    }
    custom_tooltip = th_scarlet_mists_incident_events.27.b.tt
    custom_tooltip = th_scarlet_mists_incident_events_scarlet_mist
    hidden_effect = {
      gensokyo_superregion = {
        limit = {
          NOT = {
            owned_by = SCR
          }
          NOT = {
            owned_by = SCD
          }
          NOT = {
            owned_by = FLR
          }
        }
        add_province_modifier = {
          name = th_the_scarlet_mist
          duration = 1825
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.100
  title = "th_scarlet_mists_incident_events.9.t"
  desc = "th_scarlet_mists_incident_events.9.desc"
  picture = SCARLETMIST_eventPicture
  is_triggered_only = yes
  immediate = {
    hidden_effect = {
      th_resolve_incident = {
        incident = scarlet_mists_incident
      }
    }
  }
  major = yes
  option = {
    name = "th_scarlet_mists_incident_events.9.a"
    custom_tooltip = th_scarlet_mists_incident_events.9.a.tt
    if = {
      limit = {
        exists = SCD
      }
      SCD = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    else_if = {
      limit = {
        exists = SCR
      }
      SCR = {
        add_country_modifier = {
          name = "th_SDM_inci_mist_spreading"
          duration = 1825
        }
      }
    }
    add_adm_power = -100
    add_prestige = -10
    add_devotion = -10
    custom_tooltip = th_scarlet_mists_incident_events_scarlet_mist
    hidden_effect = {
      gensokyo_superregion = {
        limit = {
          NOT = {
            owned_by = SCR
          }
          NOT = {
            owned_by = SCD
          }
          NOT = {
            owned_by = FLR
          }
        }
        add_province_modifier = {
          name = th_the_scarlet_mist
          duration = 1825
        }
      }
    }
  }
}
country_event = {
  id = th_scarlet_mists_incident_events.1000
  title = none
  desc = none
  picture = SCARLETMIST_eventPicture
  hidden = yes
  is_triggered_only = yes
  immediate = {
    th_incident_forbid_country_to_investigate = {
      who = SCR
    }
    th_incident_forbid_country_to_investigate = {
      who = SCD
    }
    th_incident_forbid_country_to_investigate = {
      who = CIN
    }
    th_incident_forbid_country_to_investigate = {
      who = FLR
    }
    th_incident_forbid_country_to_investigate = {
      who = HNG
    }
    th_start_incident_effect = {
      incident = scarlet_mists_incident
    }
    gensokyo_superregion = {
      limit = {
        owner = {
          NOT = {
            tag = SCR
          }
          NOT = {
            tag = SCD
          }
          NOT = {
            was_tag = SCR
          }
          NOT = {
            was_tag = SCD
          }
          NOT = {
            is_subject_of = SCR
          }
          NOT = {
            is_subject_of = SCD
          }
        }
        any_neighbor_province = {
          OR = {
            owned_by = SCR
            owned_by = SCD
          }
        }
        NOT = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
        }
      }
      add_province_modifier = {
        name = th_plagued_by_the_scarlet_mist
        duration = -1
        desc = th_incident_duration_tt
      }
    }
    random_province = {
      limit = {
        superregion = gensokyo_superregion
        owner = {
          NOT = {
            tag = SCR
          }
          NOT = {
            tag = SCD
          }
          NOT = {
            was_tag = SCR
          }
          NOT = {
            was_tag = SCD
          }
          NOT = {
            is_subject_of = SCR
          }
          NOT = {
            is_subject_of = SCD
          }
        }
        NOT = {
          has_province_modifier = th_plagued_by_the_scarlet_mist
        }
      }
      add_province_modifier = {
        name = th_plagued_by_the_scarlet_mist
        duration = -1
        desc = th_incident_duration_tt
      }
    }
  }
  option = {
    random_country = {
      limit = {
        th_incident_can_become_investigator = yes
      }
      th_incident_setup_investigator = yes
      th_incident_introduction_event = {
        id = th_scarlet_mists_incident_events.1
      }
    }
    ai_chance = {
      factor = 100
    }
  }
}